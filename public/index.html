<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HarborLog</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <header>
    <h1>HarborLog</h1>
    <p>Maritime Vessel Logging System</p>
  </header>

  <main>
    <section id="login-section" class="card">
      <h2>Login</h2>
      <form id="login-form">
        <label>Username
          <input type="text" id="username" required />
        </label>
        <label>Password
          <input type="password" id="password" required />
        </label>
        <button type="submit">Sign In</button>
      </form>
      <small>Default admin: <code>admin / admin123</code></small>
    </section>

    <section id="dashboard-section" class="hidden">
      <div class="card">
        <div class="row">
          <h2>Dashboard</h2>
          <button id="logout-btn" class="secondary">Logout</button>
        </div>
        <p id="user-info"></p>
      </div>

      <section id="admin-panel" class="hidden">
        <div class="grid">
          <div class="card">
            <h3>Create Vessel</h3>
            <form id="vessel-form">
              <label>Vessel Name
                <input type="text" id="vessel-name" required />
              </label>
              <button type="submit">Create Vessel</button>
            </form>
          </div>

          <div class="card">
            <h3>Create User</h3>
            <form id="user-form">
              <label>Username
                <input type="text" id="new-username" required />
              </label>
              <label>Password
                <input type="password" id="new-password" required />
              </label>
              <label>Role
                <select id="new-role" required>
                  <option value="CREW">Crew</option>
                  <option value="ADMIN">Admin</option>
                </select>
              </label>
              <button type="submit">Create User</button>
            </form>
          </div>

          <div class="card">
            <h3>Assign Crew to Vessel</h3>
            <form id="assign-form">
              <label>Crew User
                <select id="assign-user" required></select>
              </label>
              <label>Vessel
                <select id="assign-vessel" required></select>
              </label>
              <button type="submit">Assign</button>
            </form>
          </div>
        </div>

        <div class="grid">
          <div class="card">
            <h3>Vessels</h3>
            <ul id="vessels-list"></ul>
          </div>
          <div class="card">
            <h3>Users</h3>
            <ul id="users-list"></ul>
          </div>
          <div class="card">
            <h3>Assignments</h3>
            <ul id="assignments-list"></ul>
          </div>
        </div>


          <div class="card">
            <div class="row">
              <h3>Daily Ops Reports (Admin View)</h3>
              <button id="refresh-admin-ops" class="secondary">Refresh</button>
            </div>
            <ul id="admin-ops-list"></ul>
          </div>

      </section>

      <section id="crew-panel" class="hidden">
        <div class="card">
          <h3>Assigned Vessel</h3>
          <p id="assigned-vessel">Loading...</p>
        </div>

        <div class="card">
          <div class="subnav">
            <button id="nav-new-entry" class="secondary">New Entry</button>
            <button id="nav-timeline" class="secondary">Timeline</button>
            <button id="nav-summary" class="secondary">Daily Summary</button>
            <button id="nav-report" class="secondary">Daily Ops Report</button>
          </div>
        </div>

        <section id="crew-new-entry" class="card">
          <h3>New Entry (Fast Logging)</h3>
          <p class="muted">Timestamp is auto-filled at submission time.</p>
          <form id="entry-form">
            <label>Vessel
              <input type="text" id="entry-vessel" readonly />
            </label>
            <label>Category
              <select id="entry-category" required>
                <option value="Weather">Weather</option>
                <option value="Operations">Operations</option>
                <option value="Safety">Safety</option>
                <option value="Issue/Delay">Issue/Delay</option>
              </select>
            </label>
            <label>Notes
              <textarea id="entry-notes" rows="4" required placeholder="Enter a short operational note..."></textarea>
            </label>
            <button type="submit">Save Entry</button>
          </form>
        </section>

        <section id="crew-timeline" class="card hidden">
          <h3>Chronological Timeline</h3>
          <ul id="timeline-list"></ul>
        </section>

        <section id="crew-summary" class="card hidden">
          <div class="row">
            <h3>Daily Summary</h3>
            <div class="row compact">
              <select id="summary-day-picker"></select>
              <button id="export-day-btn" class="secondary">Export Day PDF</button>
            </div>
          </div>
          <div id="summary-days"></div>
        </section>


        <section id="crew-ops-report" class="card hidden">
          <div class="row">
            <h3>Daily Ops Report</h3>
            <button id="export-ops-om-pdf-btn" class="secondary">Export OM PDF</button>
          </div>
          <form id="daily-ops-form">
            <label>Report Date
              <input type="date" id="ops-report-day" required />
            </label>
            <div class="grid">
              <label>Position Type
                <select id="position-type" required>
                  <option value="LatLon">LatLon</option>
                  <option value="Block">Block</option>
                </select>
              </label>
              <label>Position Text
                <input type="text" id="position-text" placeholder="29°12.3'N 89°45.6'W or MC-759" required />
              </label>
              <label>Status
                <input type="text" id="ops-status" required />
              </label>
              <label>Status Notes
                <input type="text" id="status-notes" required />
              </label>
              <label>Destination / Location
                <input type="text" id="destination-location" required />
              </label>
              <label>ETA (optional)
                <input type="datetime-local" id="eta" />
              </label>
              <label>Wind
                <input type="text" id="wind" placeholder="NE 20 kts" required />
              </label>
              <label>Seas
                <input type="text" id="seas" placeholder="4-6 ft" required />
              </label>
              <label>Visibility
                <input type="text" id="visibility" required />
              </label>
              <label>Fuel Onboard
                <input type="number" step="0.1" id="fuel-onboard" required />
              </label>
              <label>Fuel Used 24h
                <input type="number" step="0.1" id="fuel-used-24h" required />
              </label>
              <label>Water Onboard
                <input type="number" step="0.1" id="ops-water-onboard" required />
              </label>
              <label>Lube Oil Onboard
                <input type="number" step="0.1" id="lube-oil-onboard" required />
              </label>
              <label>Fuel Ticket Number
                <input type="text" id="fuel-ticket-number" required />
              </label>
              <label>Fuel Ticket Attachment
                <input type="file" id="fuel-ticket-attachment" accept=".pdf,application/pdf" />
              </label>
              <label>POB
                <input type="number" id="ops-pob" required />
              </label>
              <label>Next Crew Change Date (optional)
                <input type="date" id="next-crew-change-date" />
              </label>
              <label>JSA Count (optional)
                <input type="number" id="ops-jsa-count" />
              </label>
            </div>
            <label>JSA Breakdown (optional)
              <textarea id="jsa-breakdown" rows="3"></textarea>
            </label>
            <button type="submit">Save Midnight Daily Ops Report</button>
          </form>

          <div class="row" style="margin-top:0.75rem;">
            <button id="export-ops-office-pdf-btn" class="secondary">Export Office PDF</button>
          </div>
          <div class="grid" style="margin-top:0.75rem;">
            <div class="card">
              <h4>OM View (Nightly Email Format)</h4>
              <pre id="om-view" class="email-view"></pre>
              <p id="om-ticket-link" class="muted"></p>
            </div>
            <div class="card">
              <h4>Office View (Office Email Format)</h4>
              <pre id="office-view" class="email-view"></pre>
              <p id="office-ticket-link" class="muted"></p>
            </div>
          </div>

        </section>

      </section>
    </section>

    <p id="status"></p>
  </main>

  <script src="/app.js"></script>
</body>
</html>
